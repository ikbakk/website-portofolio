---
import { useSanityClient } from "@sanity/astro";
import {
  projectDetailQuery,
  projectOverviewQuery,
} from "../../lib/sanityQueries";
import type { ProjectDetails, ProjectOverview } from "../../../types";
import Layout from "@/layouts/Layout.astro";

export async function getStaticPaths() {
  const projects: ProjectOverview[] =
    await useSanityClient().fetch(projectOverviewQuery);

  return projects.map((project) => ({
    params: {
      project: project.slug.current,
    },
  }));
}

const { project } = Astro.params;

const projectProps: ProjectDetails = await useSanityClient().fetch(
  projectDetailQuery,
  {
    slug: project,
  },
);
---

<Layout title={projectProps.title}>
  {JSON.stringify(projectProps)}
</Layout>
